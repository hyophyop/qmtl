# Example unified configuration for local development.
# Adjust endpoints and credentials to match your deployment.

worldservice:
  url: http://localhost:8080
  timeout: 0.3
  retries: 2
  enable_proxy: true
  enforce_live_guard: true
  cache_ttl_seconds: 300
  cache_max_entries: 128

gateway:
  host: 0.0.0.0
  port: 8000
  redis_dsn: redis://localhost:6379
  database_backend: sqlite
  database_dsn: ./qmtl.db
  insert_sentinel: true
  controlbus_topics:
    - activation
    - policy
    - queue
  controlbus_group: gateway
  commitlog_topic: gateway.ingest
  commitlog_group: gateway-commit
  commitlog_transactional_id: gateway-commit-writer

# The DAG Manager can run entirely in-memory (default) or target external stores.
dagmanager:
  memory_repo_path: memrepo.gpickle
  neo4j_dsn: bolt://localhost:7687
  neo4j_user: neo4j
  neo4j_password: neo4j
  kafka_dsn: localhost:9092
  grpc_host: 0.0.0.0
  grpc_port: 50051
  http_host: 0.0.0.0
  http_port: 8001
  controlbus_dsn: localhost:9092
  controlbus_queue_topic: queue

seamless:
  coordinator_url: http://localhost:5010
  artifacts_enabled: false
  artifact_dir: ~/.qmtl_seamless_artifacts
  fingerprint_mode: canonical
  publish_fingerprint: true
  preview_fingerprint: false
  early_fingerprint: false
  sla_preset: baseline
  conformance_preset: strict-blocking

connectors:
  ccxt_rate_limiter_redis: redis://localhost:6379/0
  schema_registry_url: http://localhost:8081
  worker_id: worker-1
  seamless_worker_id: seam-01
  strategy_id: sample-strategy
  execution_domain: dryrun
  broker_url: https://broker/api/orders
  trade_max_retries: 3
  trade_backoff: 0.1
  ws_url: wss://gateway/ws

telemetry:
  otel_exporter_endpoint: http://localhost:4318/v1/traces
  enable_fastapi_otel: false
  prometheus_url: http://localhost:9090

cache:
  arrow_cache_enabled: false
  cache_evict_interval: 60
  feature_artifacts_enabled: false
  feature_artifact_dir: .qmtl_feature_artifacts
  feature_artifact_versions: 5
  feature_artifact_write_domains:
    - equities.live
  tagquery_cache_path: .qmtl_tagmap.json
  snapshot_dir: .qmtl_snapshots
  snapshot_url: null
  snapshot_strict_runtime: false
  snapshot_format: json

runtime:
  http_timeout_seconds: 2.0
  http_timeout_seconds_test: 1.5
  ws_recv_timeout_seconds: 30.0
  ws_recv_timeout_seconds_test: 5.0
  ws_max_total_time_seconds: null
  ws_max_total_time_seconds_test: 5.0
  poll_interval_seconds: 10.0
  poll_interval_seconds_test: 2.0

test:
  test_mode: false
  fail_on_history_gap: false
  fixed_now: null
  history_start: null
  history_end: null
  enable_topic_namespace: true
