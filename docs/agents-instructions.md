# Agent Instructions

This file is auto-generated by `scripts/build_agent_instructions.py`.

## AGENTS.md (scope: repository root)

# Development Guidelines

This repository hosts strategy experiments built on top of the [QMTL](qmtl/README.md) subtree. For comprehensive policies—such as the QMTL subtree workflow, testing commands, and the AlphaDocs process—see [CONTRIBUTING.md](CONTRIBUTING.md).
Key reminders:

- Always synchronize the `qmtl/` subtree before starting work and push upstream after making changes.
- Strategy-specific code lives under `strategies/`; keep reusable utilities only in `qmtl/`.
- When modifying the subtree itself, follow `qmtl/AGENTS.md`. For strategy conventions, refer to `strategies/AGENTS.md`.
- If any `AGENTS.md` files change, run `uv run python scripts/build_agent_instructions.py` to refresh `docs/agents-instructions.md` before committing. CI already runs this when relevant, so running it locally avoids surprises.

Automation helpers

- A pair of helper scripts are provided under `scripts/` to standardize common tasks:
	- `scripts/bootstrap.sh` — create `uv` venv, install editable `qmtl[dev]` deps and run a fast smoke test (strategies tests if present).
	- `scripts/sync_qmtl.sh` — fetch and pull the `qmtl` subtree from the `qmtl-subtree` remote and print recent commits for verification.

Please run `scripts/bootstrap.sh` when setting up a dev environment. If you modify any files under `qmtl/`, run `scripts/sync_qmtl.sh` to pull upstream changes before making edits and follow subtree push instructions when pushing changes back upstream.

CI / Docs triggers

- The CI workflow will run the agent docs build step when `AGENTS.md` changes. If you update `AGENTS.md`, ensure `docs/agents-instructions.md` is refreshed by running:

```bash
uv run python scripts/build_agent_instructions.py
```

This repository's maintainers aim to keep the doc build step in CI to prevent stale agent instructions.

## qmtl/AGENTS.md (scope: qmtl subtree)

# Development Guidelines

**Applies to files under `qmtl/`.**

For general contribution and testing policies, see the repository root [AGENTS.md](../AGENTS.md).

## Environment

- Manage the Python environment using **uv**. Install dependencies with
  `uv pip install -e .[dev]` and build distributable wheels via `uv pip wheel .`.

## Architecture

- Follow the upstream QMTL architecture docs (examples: architecture, gateway, DAG manager). In this subtree snapshot those files are not vendored; refer to the upstream repository documentation instead.
  - Upstream docs: https://github.com/hyophyop/qmtl
- Do not place alpha or strategy modules in `qmtl/`; only reusable feature extraction or
  data-processing utilities belong here. All alpha logic should live in the root project's
  `strategies/` directory.

## Documentation Management

- Store documentation in the `docs/` directory with descriptive filenames.
- Each Markdown file should start with a single `#` heading and use relative links to other docs.
- Update `mkdocs.yml` navigation when adding or moving files.
- Validate docs with `uv run mkdocs build` before committing. Ensure `mkdocs-macros-plugin`
  and `mkdocs-breadcrumbs-plugin` are installed via `uv pip install -e .[dev]`.

## Example Projects

Example strategies under `qmtl/examples/` follow the same conventions as the rest of the
project:

- Run tests with `uv run -m pytest -W error`.
- Place node processors under `nodes/` and tests under `tests/`.
- Keep functions pure and free of side effects.

## External alpha ideas

- Prioritization of alpha ideas (including `docs/alphadocs/ideas/gpt5pro/`) is managed at the repository root. The `qmtl/` subtree should not implement alphas directly; reference the root guidelines instead.

## strategies/AGENTS.md (scope: strategies directory)

# Strategy Guidelines

These guidelines apply to all files under the `strategies/` directory. General repository setup and testing rules are described in the root [AGENTS.md](../AGENTS.md).

## Setup

Follow the instructions in the root `AGENTS.md` to set up the environment and run tests. No strategy-specific setup is required.

## Development

- Implement node processors as pure functions under `nodes/` so they can be reused across DAGs.
- Define strategy DAGs in `dags/` using `qmtl.dag_manager` for orchestration.
- Connect nodes by wiring explicit output keys to input parameters; the graph must remain acyclic and each node name unique.
- Use `snake_case` for file and function names. Name node processor functions with the `_node` suffix and DAG modules with the `_dag.py` suffix.

## Testing

- Add tests for strategy behavior under `strategies/tests/`.
- Run the repository's test suite from the project root as documented in the root `AGENTS.md`.
