
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>World refined - QMTL Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QMTL Documentation" class="md-header__button md-logo" aria-label="QMTL Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QMTL Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              World refined
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QMTL Documentation" class="md-nav__button md-logo" aria-label="QMTL Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    QMTL Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MAINTENANCE_SCHEDULE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintenance Schedule
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture & Ownership
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/dag-manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DAG Manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/gateway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gateway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/worldservice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    World Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/controlbus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ControlBus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/lean_brokerage_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lean Brokerage Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/brokerage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Brokerage API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/implementation_todos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implementation TODOs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/sdk_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SDK Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/strategy_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategy Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/backfill/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backfill
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/canary_rollout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Canary Rollout
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/e2e_testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    E2E Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/activation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    World Activation Runbook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/risk_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Risk Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/timing_controls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Timing Controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api_world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    World API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/enhanced_validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enhanced Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/backtest_validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backtest Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/lean_like_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lean-like Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/brokerage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Brokerage API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/_inventory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/CHANGELOG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    World
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            World
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../world/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../realm_rename_eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Realm Terminology Evaluation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../archive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../templates/template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Template
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>World refined</h1>

<p><a href="/">Home</a> / <a href="/world">world</a> / <a href="/world/world_refined">world_refined</a>
아래는 <strong>현재 리서치 목적과 결과(설계 초안)</strong>을 비판적으로 검토하고, 전면 개선 방향과 구체 보완안을 정리한 내용입니다. 실행 관점에서 즉시 반영 가능한 설계 수정안, 정책 DSL, 전환 알고리즘, 운영/관측 체계, 작업 목록까지 포함했습니다.</p>
<p>⸻</p>
<p>1) 리서치 목적의 적합성 &amp; 간극</p>
<p>목적 요약
    •   월드(World)를 전략 상위 추상화로 두고, 현재 데이터 타임스탬프에 따라 제출된 전략을 백테스트→드라이런(모의 실현손익 추적 포함)→라이브로 정책 기반 자동 전환.
    •   전환/설정은 QMTL CLI/API(Gateway 연계)에서 외부 제어.
    •   임계값·Top‑K·상관·히스테리시스 등을 AND/OR로 조합 가능한 평가정책.</p>
<p>무엇이 잘 맞았는가
    •   QMTL이 PaperTrading↔Brokerage 전환, Runner, 성능 측정 노드(Sharpe, MDD 등) 및 메트릭 수집(예: Prometheus) 등을 이미 갖추고 있어 “검증→승격” 파이프라인이 자연스레 통합 가능합니다. 설계 초안에서도 Runner 모드 전환과 성능 수집/선정/Top‑K가 일관된 흐름으로 제시되어 있습니다.  ￼  ￼
    •   월드 경계에서 정책·리소스·관측을 묶고, 월드별 정책/Top‑K/히스테리시스·브로커리지·모드 전환을 관리하도록 한 방향성은 적절합니다. 구성 스키마(YAML)와 예시 CLI도 유용합니다.  ￼  ￼</p>
<p>핵심 간극(비판점)
    1.  시간·데이터 정합성 정의 부족
    •   “현재 데이터 타임스탬프에 따라 백테스트 vs 드라이런 시작”의 판별 규칙과 데이터 랙 허용치(예: exchange D+1 정산) 정의가 없다. 이 구간이 불명확하면 룩어헤드/서바이벌 바이어스가 스며들 수 있다.
    2.  표본 충분성/통계적 유의성 결여
    •   임계값/Top‑K 중심은 “평균적 우월성”은 보이지만, 표본 수(T, Nfills), 신뢰구간, 다중가설 보정(탐색 편향), 워크‑포워드/퍼지드 CV 등 과적합 방지 요소가 빠져 있다.
    3.  전환 원자성·안전성 시멘틱 미비
    •   드라이런→라이브 전환 시 이중 주문 방지, 세션 드레인, 청산/이월 규칙, 일시 동결과 롤백 등 금융 시스템의 필수 안전장치와 Idempotency 요건이 설계로 못 박혀야 한다.
    4.  포트폴리오·리스크 총량 관리 부족
    •   상관 제약만으로는 불충분. 월드 레벨 리스크 버짓(예: VAR, gross/net, sector/asset cap, side별 한도), 마진/레버리지 제약, 드로우다운 컷·서킷브레이커가 필요.
    5.  멀티‑월드·공유 노드 운영 위험
    •   World‑SILO/SHARED 혼합은 비용에 유리하지만, 경계/권한/자원 격리와 가지치기(Mark‑&amp;‑Sweep) 시 안전 드레인 규칙이 강제되지 않으면 운영 리스크가 있다. 초안에 방향성은 있으나 보호장치가 부족하다.  ￼
    6.  운영성(관측·감사·권한)
    •   정책/상태 변경에 대한 감사로그, 버전 롤백, SLO/알림 룰 표준화가 필요. 초안에 모니터링 연결 아이디어는 있으나, 필수 SLO와 알림 레벨이 정의돼야 한다.  ￼</p>
<p>⸻</p>
<p>2) 개선된 전체 설계 (핵심 제안)</p>
<p>A. 시간·데이터 시맨틱: “데이터 통화성(Data Currency) 게이트”
    •   world.data_currency: max_lag(예: 5m/1d), min_history(예: 60D), bar_alignment(세션 캘린더), warmup_periods(노드별 최댓값).
    •   상태 결정 알고리즘
    1.  t_data_end(해당 월드 데이터 레이크의 최신 시각), t_now, max_lag 비교.
    2.  t_now - t_data_end &lt;= max_lag이면 드라이런 시작, 아니면 백테스트 모드로 Catch‑Up Sim(데이터가 실시간에 수렴할 때까지) → 이후 자동 드라이런 전환.
    3.  각 지표는 metric별 최소 표본 조건(예: Sharpe: N≥30일, 거래횟수≥K, 유효 바 수≥M) 충족 전에는 ‘참고’ 단계로만 사용.
    •   이 로직은 초안의 Runner/월드 스케줄 구조와 자연스럽게 결합된다(드라이런/라이브 모드 전환은 Runner 수준에서 플래그 교체).  ￼</p>
<p>B. 평가 정책 DSL: 게이트(절대/상대) + 점수 + 제약의 3층
    •   게이트(Gate): 임계값·샘플충분성(표본 수, 유효 일수, 체결수), 안정성(변동성, 자본곡선 slope t‑stat) 조건 AND/OR 합성.
    •   점수(Score): 사용자 정의 가중합/함수(예: 중기 Sharpe + 0.1×장기 승률 − 0.2×Ulcer). 상위 정렬로 Top‑K 선정.
    •   제약(Constraints): 상관/공분산 기반 군집 제한, 섹터·심볼·사이드(Long/Short)·브로커 한도.
    •   히스테리시스/쿨다운: 승격/강등의 On/Off 이원 임계, 최소 체류 시간(min dwell), 평가주기 K회 연속 기준.
    •   월드 YAML 예시(사이드 파라미터 분리 포함):</p>
<p>selection:
  gates:
    and:
      - sharpe_mid &gt;= 0.60
      - trades_60d &gt;= 40
      - max_dd_120d &lt;= 0.25
      - sample_days &gt;= 30
  score: "sharpe_mid + 0.1<em>winrate_long - 0.2</em>ulcer_mid"
  topk:
    total: 8
    by_side: { long: 5, short: 3 }     # 롱/숏 분리
  correlation:
    max_pairwise: 0.85
  hysteresis:
    promote_after: { windows: 2 }       # 2회 연속 통과
    demote_after:  { windows: 2 }       # 2회 연속 미달
    min_dwell: "10D"</p>
<p>(월드 정책·Top‑K·히스테리시스·상관 제약 구조는 기존 제안과 호환)  ￼  ￼</p>
<p>C. 드라이런→라이브 전환의 원자성(Atomic Cutover)
    •   2‑Phase 전환 프로토콜
    1.  Freeze: 전략 신호 게이트 노드 OFF(주문 차단), 미집행 오더 취소, 체결 스트림 드레인.
    2.  Switch: Runner 재기동(mode=live), Brokerage 바인딩, 계좌/권한 검증, idempotent run_id 발급.
    3.  Unfreeze: 게이트 ON, 첫 N틱은 모니터링만(선택), 이후 정상 주문.
    •   포지션 정책(월드별): position_transition = { on_promote: "none|mirror|close_and_reopen", on_demote: "market|twap|none" }
    •   기본값은 미이월(시장가 진입/청산 없음). 접근성은 있으되 보수적 기본값으로 사고 위험을 낮춤.
    •   초안이 제시한 PaperTrading↔Brokerage 전환을 원자화·안전장치와 함께 고정시킵니다.  ￼</p>
<p>D. 월드 레벨 리스크 엔진(필수)
    •   총량 한도: Gross, Net, Side별(롱/숏), 심볼·섹터·거래소, 레버리지/마진 한도.
    •   실시간 컷: World‑Wide Drawdown(예: 5% Intraday), 일중 손실 한도, 체결 거부율/연결 오류율 기반 서킷 브레이커.
    •   선정과 병렬: Top‑K로 ‘무엇을’ 고르고, 리스크 엔진으로 ‘얼마나’ 할지를 결정. (선정=구성, 리스크=용량 배분/제약)</p>
<p>E. 멀티‑월드·공유 노드의 안전 운영
    •   World‑SILO 기본, SHARED 선택: 노드 ID에 world_id 포함, 공용 지표/원시 데이터만 share_scope=GLOBAL 허용(점진 도입).
    •   Mark‑&amp;‑Sweep + 드레인: 월드별 활성 알파 집합을 기준으로 역방향 마킹 후, <strong>드레인 시간(최대 period×interval)</strong>을 보장하고 비표시 노드만 정리. 버전드 DAG + 롤백 포인트 필수.  ￼
    •   초안의 가지치기/파티셔닝 원칙을 안전장치 포함으로 강화.  ￼</p>
<p>F. 운영·관측·감사
    •   SLO: (i) 승격/강등 지연 ≤ 1 평가주기, (ii) 전환 실패율 &lt; 0.5%, (iii) 메트릭 계산 지연 &lt; 1m.
    •   감사 로그: who/when/what(policy_id, diff) + 재현성 스냅샷(정책/데이터 버전, 지표 스냅샷, 결정 트리) 저장.
    •   알림 표준화: 승격/강등/서킷/실패/지연 레벨. 기존 메트릭·알림 연계 아이디어를 자동 액션과 묶음.  ￼</p>
<p>⸻</p>
<p>3) 정책/아키텍처 보강: 적용 청사진</p>
<p>(1) WorldService(신규 서비스, 경계 명확화)
    •   책임: 정책 파싱/검증 → 평가주기 실행 → 후보 선별(게이트→스코어→제약→Top‑K) → 전환 트랜잭션 발행.
    •   상태기계(FSM): submitted → backtest → dry-run(evaluating) → live → inactive(←→dry-run)
    •   Gateway 연결: Gateway는 실행/상태 저장에 집중, WorldService는 정책·결정에 집중(약결합).
    •   기존 Runner/메트릭 수집을 그대로 활용(설계 초안과 호환).  ￼  ￼</p>
<p>(2) API/CLI (외부 제어)
    •   CLI
    •   qmtl world apply -f world.yml (정책/리소스 버전 적용)
    •   qmtl world eval <world_id> --now (즉시 평가 트리거)
    •   qmtl strategy set-mode <sid> --world W --mode dry-run|live|stop (강제 개입)
    •   API
    •   POST /worlds/{id}/policy(버전드), POST /worlds/{id}/state(Active/EvalOnly/Paused)
    •   POST /worlds/{id}/evaluate, POST /strategies/{sid}/promote|demote
    •   권한: world‑scope RBAC(Owner/Operator). 초안의 CLI/구성과 일치하되 경계·권한을 더 명확히.  ￼</p>
<p>(3) 평가 엔진: 결정의 재현성과 안전성
    •   결정 함수 decide(world_snapshot) -&gt; plan: 입력(정책 버전·지표 스냅샷·Top‑K 계산 기록)을 불변 스냅샷으로 받아 순수 함수처럼 동작 → 결과(plan)를 원자 적용.
    •   쿨다운/히스테리시스: 정책에 명시된 promote_after/demote_after/min_dwell.
    •   샘플충분성: metric별 min_trades, min_days, min_bars를 gate에 반드시 포함. (예: Sharpe 통계적 신뢰 낮을 땐 ‘참고’만)</p>
<p>⸻</p>
<p>4) 실패 모드와 방어선 (현장 체크리스트)
    •   토글 플리커: 히스테리시스+쿨다운+min_dwell로 차단(정책 기본값을 보수적으로).  ￼
    •   이중 주문/유령 포지션: 게이트 노드 + 2‑Phase 전환 + 미집행 오더 취소 + idempotent run_id.
    •   과적합: walk‑forward, purged CV, deflated Sharpe(추가 분석 파이프).
    •   데이터 공백/지연: data_currency 게이트(정책상 max_lag 위반 시 자동 Eval‑Only).
    •   공유 노드 청소 중 오차: Mark‑&amp;‑Sweep에서 드레인 보장과 버전 롤백.  ￼</p>
<p>⸻</p>
<p>5) 적용을 위한 세부 작업 목록(개선판)</p>
<p>A. 도메인/스토어
    1.  World, WorldPolicy(vN), StrategyInstance 스키마 + 상태FSM 컬럼/인덱스.  ￼
    2.  감사/결정 로그 테이블(정책 diff, 입력 지표 스냅샷, Top‑K 결과, 전환 plan, 실행 결과).</p>
<p>B. 정책/평가
3. Policy DSL(Gate/Score/Constraint/Hysteresis) 파서 + 검증기.
4. 샘플충분성 게이트(metric별 min sample), data_currency 게이트(max_lag/min_history).
5. 평가 엔진(순수 결정 함수 + 스냅샷 로딩) 및 스케줄러(APScheduler/cron).</p>
<p>C. 실행/전환
6. 게이트 노드(Order 앞단 AND 스위치) 및 글로벌 활성 테이블(런타임 조회).  ￼
7. 2‑Phase 전환기: Freeze/Drain→Switch→Unfreeze, idempotent run_id, 실패 롤백.
8. 포지션 정책(on_promote/on_demote) 적용기(기본 미이월).</p>
<p>D. 멀티‑월드/자원
9. World‑SILO 기본/SHARED 선택: NodeID 해시 스킴, Kafka 네임스페이스, 파티션 뷰.  ￼
10. Mark‑&amp;‑Sweep with Drain + 버전드 DAG/롤백 체크포인트.  ￼</p>
<p>E. 관측/운영
11. SLO/알림 룰 표준화(승격/강등/실패/지연/서킷). 기존 메트릭과 연계(알림→액션).  ￼
12. CLI/API 확장(버전 적용, 즉시 평가, 강제 모드 전환), world‑scope RBAC.  ￼</p>
<p>⸻</p>
<p>6) 사용자가 중시한 “파라미터 분리” 반영
    •   사이드별 분리: topk.by_side, gates.side.long/short, 자금·리스크 버짓도 side별로 분리. (예: gross_budget: { long: 60%, short: 40% })
    •   전략 파라미터 분리: 동일 전략 코드라도 StrategyInstance(params)를 월드/사이드 별 인스턴스로 관리.  ￼</p>
<p>⸻</p>
<p>7) 기대 효과(시나리오: +/0/−)
    •   긍정(+): 월드 경계에서 정책/리소스/관측을 분리, 자동 전환 안전성↑, 비용은 공유 노드로 절감. 승격/강등의 판정 재현성과 감사 추적성 확보.  ￼
    •   중립(0): SHARED 도입으로 구성 복잡도↑. SILO 기본 → SHARED 점진 도입 전략이면 초기 리스크 관리 가능.  ￼
    •   부정(−): 드레인/히스테리시스/리스크 컷이 없으면 토글·자원 난립·예상치 못한 주문 발동 위험. (정책 기본값 보수적 설정 권고)  ￼</p>
<p>⸻</p>
<p>8) 한눈에 보는 “개선된 상태 결정” 의사 코드</p>
<p>def decide_initial_mode(world, now, data_end):
    if (now - data_end) &lt;= world.data_currency.max_lag:
        return "dry-run"     # 실시간에 가깝다
    else:
        return "backtest"    # catch-up 후 dry-run 전환</p>
<p>def gate_metrics(metrics, policy):
    if metrics.sample_days &lt; policy.min_sample_days: return "insufficient"
    if metrics.trades_60d &lt; policy.min_trades: return "insufficient"
    # 임계값/AND-OR 조합
    return "pass" if eval_expr(policy.gates, metrics) else "fail"</p>
<p>def hysteresis(prev_state, checks, policy):
    dwell_ok = time_in_state(prev_state) &gt;= policy.hysteresis.min_dwell
    if checks.consecutive_pass &gt;= policy.hysteresis.promote_after and dwell_ok:
        return "PROMOTE"
    if checks.consecutive_fail &gt;= policy.hysteresis.demote_after and dwell_ok:
        return "DEMOTE"
    return "HOLD"</p>
<p>⸻</p>
<p>9) 본 설계가 기존 결과와 합치/강화되는 지점
    •   Runner 모드 전환·PaperTrading↔Brokerage 전환은 그대로 활용하되, 게이트 노드+2‑Phase 전환으로 금융 시스템에 필요한 원자성·안전장치를 부여.  ￼
    •   월드 정책/Top‑K/히스테리시스·가지치기(Mark‑&amp;‑Sweep) 구상은 유지하되, 데이터 통화성/표본충분성/리스크 총량을 정식 게이트로 승격.  ￼  ￼
    •   CLI/API는 Gateway를 기본 채널로 하되, WorldService를 분리해 구조적 명확성 확보(정책 결정은 WorldService, 실행/상태는 Gateway).  ￼</p>
<p>⸻</p>
<p>마치며</p>
<p>제안된 개선안은, 이미 문서에서 강점으로 식별된 월드 경계·Runner 모드 전환·성과 측정 인프라(Prometheus/성능노드)와 전역 DAG 재사용을 유지하면서, 시간/표본/전환/리스크/운영 5축의 빈틈을 메워 실전 안전성과 재현성을 크게 끌어올립니다. 필요하시면 위 정책 DSL 스키마와 2‑Phase 전환기를 바탕으로 world.yml 템플릿·API 명세·통합 테스트 시나리오까지 한 번에 정리해 드리겠습니다.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "navigation.expand", "navigation.path"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>