version: 1
sla_presets:
  baseline:
    description: >-
      Balanced SLA for ccxt polling workloads. Blocks responses when storage, backfill,
      or live waits exceed their budget so gaps surface quickly in staging.
    policy:
      total_deadline_ms: 60000
      max_wait_storage_ms: 3000
      max_wait_backfill_ms: 45000
      max_wait_live_ms: 5000
      retry_backoff_ms: 500
      min_coverage: 0.98
      max_lag_seconds: 45
      on_violation: fail_fast
  tolerant-partial:
    description: >-
      Allows partial fills for exploratory notebooks while still bounding latency.
    policy:
      total_deadline_ms: 90000
      max_wait_storage_ms: 5000
      max_wait_backfill_ms: 75000
      max_wait_live_ms: 7000
      retry_backoff_ms: 1000
      min_coverage: 0.9
      max_lag_seconds: 90
      on_violation: partial_fill
conformance_presets:
  strict-blocking:
    description: >-
      Enforces schema rollups and rejects frames that raise any conformance warnings.
    partial_ok: false
    interval_ms: 60000
    schema:
      fields:
        - name: ts
          dtype: datetime64[ns]
        - name: open
          dtype: float64
        - name: high
          dtype: float64
        - name: low
          dtype: float64
        - name: close
          dtype: float64
        - name: volume
          dtype: float64
  permissive-dev:
    description: >-
      Keeps the conformance pipeline enabled but allows responses to pass with warnings.
      Useful for local development and dataset audits.
    partial_ok: true
    interval_ms: null
    schema: {}
data_presets:
  ohlcv.binance.spot.1m:
    kind: "ohlcv"
    interval_ms: 60000
    stabilization_bars: 2
    sla_preset: "baseline"
    conformance_preset: "strict-blocking"
    provider:
      preset: "demo.inmemory.ohlcv"
      options:
        bars: 360
        seed: 11
  ohlcv.polygon.us_equity.1d:
    kind: "ohlcv"
    interval_ms: 86400000
    stabilization_bars: 0
    sla_preset: "tolerant-partial"
    conformance_preset: "strict-blocking"
    provider:
      preset: "demo.inmemory.ohlcv"
      options:
        bars: 180
        seed: 17
  # Nautilus Catalog presets — historical data from DataCatalog
  ohlcv.nautilus.crypto.1m:
    kind: "ohlcv"
    interval_ms: 60000
    stabilization_bars: 2
    sla_preset: "baseline"
    conformance_preset: "strict-blocking"
    provider:
      preset: "nautilus.catalog"
      options:
        catalog_path: "~/.nautilus/catalog"
        priority: "STORAGE"

  ohlcv.nautilus.crypto.1h:
    kind: "ohlcv"
    interval_ms: 3600000
    stabilization_bars: 1
    sla_preset: "baseline"
    conformance_preset: "strict-blocking"
    provider:
      preset: "nautilus.catalog"
      options:
        catalog_path: "~/.nautilus/catalog"
        priority: "STORAGE"

  # Nautilus Full preset — historical (Nautilus Catalog) + live (CCXT Pro)
  ohlcv.nautilus.binance.1m:
    kind: "ohlcv"
    interval_ms: 60000
    stabilization_bars: 2
    sla_preset: "baseline"
    conformance_preset: "strict-blocking"
    provider:
      preset: "nautilus.full"
      options:
        catalog_path: "~/.nautilus/catalog"
        exchange_id: "binance"
        timeframe: "1m"
        mode: "ohlcv"

  ohlcv.nautilus.binance.1h:
    kind: "ohlcv"
    interval_ms: 3600000
    stabilization_bars: 1
    sla_preset: "baseline"
    conformance_preset: "strict-blocking"
    provider:
      preset: "nautilus.full"
      options:
        catalog_path: "~/.nautilus/catalog"
        exchange_id: "binance"
        timeframe: "1h"
        mode: "ohlcv"